# ctrlx-webserver

May 2024, DCEM Bosch Rexroth

Contact: Aria Malik Havidiansyah (ariamalik.havidiansyah@boschrexroth.de) and Raul Cruz Oliver (raul.cruz-oliver@boschrexroth.ch)

## Introduction

This repository contains the source code to build your own custom user interface based on a Python Flask webserver. The webserver communicates with the official ctrlX Motion app though the datalayer.

In the following image one can see an overview of the system topology. 

![alt text](docs/images/overview.png)

As presented in the image, the custom webserver is available through the port 5000. 

For complementary, we are showing that the basic web interface provided by ctrlX OS is available in the port 8443.

### Target platform
This example has been developped for ctrlX OS 2.4, in which the official 2.4 version of the Motion App has been installed.

**NOTE:** In version 2.6 there would be substancial changes in the way metadata is managed, we will provide an example for this new ctrlX OS as soon at is available in a different branch in this repository. Stay tuned!

## File description

## Implementation information

### Flatbuffers

### Metadata

## Function Description

### ctrlX OS setup

### Webserver functionalities




The app connects to the ctrlX Data Layer and provides a string and flatbuffers node .

If the Data Layer connection breaks the app will exit. After 10s it will be automatically restarted by snapd.




## Implementation Description

### Compile Flatbuffers Schema

This app uses a flatbuffer defined in the schema file sampleSchema.fbs. From this schema file we have to create a binary file which is registered on the ctrlX and a Python class to create and access the defined flatbuffer data. These tasks can be done with the command line tool flatc.

This tool is provided by this SDK under /bin/oss.flatbuffers/..insert OS version here../release/

Do following steps - OS version here is 'linux-gcc-x64':

* Create a binary flatbuffers file:

    ../../bin/oss.flatbuffers/linux-gcc-x64/release/flatc -o bfbs/ -b --schema sampleSchema.fbs

* Generate the Python code:

    ../../bin/oss.flatbuffers/linux-gcc-x64/release/flatc --python sampleSchema.fbs

The generated code is stored in sample/schema/InertialValue.py

### Modules

* The module __main.py__ manages the Data Layer connection and the creation of the Data Layer nodes.
* The module __app/my_provider_node.py__ contains the class MyProviderNode with the callback function needed by the Data Layer.
* The file __sampleSchema.fbs__ contains the schema for the flatbuffers data struct used by this app.
* The module __sample/schema/InertialValue.py__ is generated by flatc from sampleSchema.fbs. It is used to manage the flatbuffers data struct.

___

